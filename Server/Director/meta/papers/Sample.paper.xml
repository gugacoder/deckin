<?xml version="1.0" encoding="UTF-8"?>
<QueryTemplate
  Title="Usuários"
  Disabled="false"
  Connection="Director">
  <Actions>
    <GridAction
      Title="Usuários"
      Limit="100"
      AutoRefresh="2"
      EntityName="Usuario">
      <Query><![CDATA[
        select top (@limit)
               TBusuario.DFid_usuario
             , TBusuario.DFnome_usuario
             , TBempresa.DFcod_empresa
             , TBempresa.DFnome_fantasia
             , TBnivel.DFid_nivel_usuario
             , TBnivel.DFdescricao
          from TBusuario
          left join TBempresa
                 on TBempresa.DFcod_empresa = TBusuario.DFcod_empresa
          left join TBnivel
                 on TBnivel.DFid_nivel_usuario = TBusuario.DFnivel_usuario
         where TBusuario.DFid_usuario matches if set @DFid_usuario
           and TBusuario.DFnome_usuario matches if set @DFnome_usuario
           and TBempresa.DFcod_empresa matches if set @DFcod_empresa
           and TBempresa.DFnome_fantasia matches if set @DFnome_fantasia
           and TBnivel.DFid_nivel_usuario matches if set @DFid_nivel_usuario
           and TBnivel.DFdescricao matches if set @DFnivel_usuario
      ]]></Query>
      <Filter>
        <TextField
          Name="DFid_usuario"
          Title="Código de Usuário" />
        <TextField
          Name="DFnome_usuario"
          Title="Nome de Usuário" />
        <TextField
          Name="DFcod_empresa"
          Title="Código da Empresa" />
        <TextField
          Name="DFnome_fantasia"
          Title="Nome da Empresa" />
        <TextField
          Name="DFid_nivel_usuario"
          Title="Código do Nível" />
        <TextField
          Name="DFnivel_usuario"
          Title="Nome do Nível" />
      </Filter>
    </GridAction>
    <CardAction
      Title="Usuário"
      EntityName="Usuario"
      Extent="lg-extent">
      <Query><![CDATA[
        select TBusuario.DFid_usuario
             , TBusuario.DFnome_usuario
             , TBempresa.DFcod_empresa
             , TBempresa.DFnome_fantasia
             , TBnivel.DFid_nivel_usuario
             , TBnivel.DFdescricao
          from TBusuario
          left join TBempresa
                 on TBempresa.DFcod_empresa = TBusuario.DFcod_empresa
          left join TBnivel
                 on TBnivel.DFid_nivel_usuario = TBusuario.DFnivel_usuario
         where TBusuario.DFid_usuario = @key
      ]]></Query>
      <Fields>
        <Field
          Name="DFid_usuario"
          Title="Código de Usuário"
          Extent="sm-extent" />
        <Field
          Name="DFnome_usuario"
          Title="Nome de Usuário" />
        <Field
          Name="DFcod_empresa"
          Title="Código da Empresa"
          Extent="sm-extent" />
        <Field
          Name="DFnome_fantasia"
          Title="Nome da Empresa" />
        <Field
          Name="DFid_nivel_usuario"
          Title="Código do Nível"
          Extent="sm-extent" />
        <Field
          Name="DFnivel_usuario"
          Title="Nome do Nível" />
      </Fields>
    </CardAction>
  </Actions>
</QueryTemplate>
<!--
<QueryTemplate
  Catalog="Sandbox"
  Name="Sample"
  Title="Sample Template"
  Disabled="false"
  Connection="Director">
  <Actions>
    <GridAction
      Name="Search"
      Title="Posts"
      Verb="Pesquisar Posts">
      <Query><![CDATA[
        SELECT post.id
             , post.title
             , post.body
             , post.author_id
             , author.name as author
          FROM __post__ as post
         INNER JOIN __author__ as author
                 on author.id = post.author_id
         WHERE (post.title matches if set @title or post.title matches if set @search)
           AND (post.body matches if set @body or post.body matches if set @search)
           AND (author.name if set matches @author or author.name matches if set @search)
      ]]></Query>
      <Fields>
        <IntField
          Name="id"
          Hidden="true" />
        <TextField
          Name="title"
          Title="Título" />
        <TextField
          Name="body"
          Title="Texto"
          Multiline="true"
          Wysiwyg="true" />
        <IntField
          Name="author_id"
          Hidden="true" />
        <TextField
          Name="author"
          Title="Autor" />
      </Fields>
      <Actions>
        <FilterAction>
          <Fields>
            <TextField
              Name="search"
              Title="Pesquisar"
              Rel="Search" />
            <TextField
              Name="title"
              Title="Título" />
            <TextField
              Name="body"
              Title="Texto" />
            <TextField
              Name="author"
              Title="Autor" />
          </Fields>
        </FilterAction>
      </Actions>
      <Linkage>
        <LinkTo
          Href="../Detail/@{id}"
          Rel="Detail" />
      </Linkage>
    </GridAction>
    <CardAction
      Name="Detail"
      Title="Post"
      Verb="Ver o Post"
      Popup="true">
      <Query><![CDATA[
        SELECT post.id
             , post.title
             , post.body
             , post.author_id
             , author.name as author
          FROM __post__ as post
         INNER JOIN __author__ as author
                 on author.id = post.author_id
         WHERE post.id = @id
      ]]></Query>
      <Fields>
        <IntField
          Name="id"
          Hidden="true" />
        <TextField
          Name="title"
          Title="Título" />
        <TextField
          Name="body"
          Title="Texto"
          Multiline="true"
          Wysiwyg="true" />
        <IntField
          Name="author_id"
          Hidden="true" />
        <TextField
          Name="author"
          Title="Autor" />
      </Fields>
      <Linkage>
        <LinkTo
          Href="../Search" />
      </Linkage>
    </CardAction>
  </Actions>
</QueryTemplate>
-->